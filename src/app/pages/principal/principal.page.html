<!-- COMPONENTE DE MENÃš -->
<app-header-menu title="ChambaNow"></app-header-menu>

<ion-content class="ion-padding" [scrollEvents]="true" (ionScroll)="onScroll($event)">

  <!-- Mensaje de Bienvenida -->
  <div class="ion-margin-bottom">
    <h2>Â¡Bienvenido/a, {{ usuario?.nombre || 'Invitado' }}! ðŸŽ‰</h2>
    <p class="ion-text-muted">AquÃ­ estÃ¡n las ofertas disponibles para ti.</p>
  </div>

  <!-- Tarjeta de informaciÃ³n de sesiÃ³n -->
  <ion-card class="ion-margin-bottom" color="light" *ngIf="usuario">
    <ion-card-content>
      <p><small><strong>Email:</strong> {{ usuario?.email }}</small></p>
      <p *ngIf="usuario?.id"><small><strong>ID Usuario:</strong> {{ usuario?.id }}</small></p>
    </ion-card-content>
  </ion-card>

  <!-- LISTA DE OFERTAS -->
  <ion-list>
    <!-- Mensaje si no hay ofertas -->
    <div *ngIf="ofertas.length === 0" class="ion-text-center ion-padding">
      <p class="ion-text-muted">No hay ofertas publicadas aÃºn.</p>
    </div>

    <ion-card
      *ngFor="let oferta of ofertas"
      (click)="verDetalle(oferta.id)"
      class="ion-activatable ripple-parent ion-margin-bottom"
    >
      <ion-ripple-effect></ion-ripple-effect>

      <ion-item lines="none">
        <ion-avatar slot="start" class="ion-margin-end">
          <img [src]="oferta.imagenUrl" 
               alt="Icono" 
               onerror="this.src='https://ionicframework.com/docs/img/demos/avatar.svg'" />
        </ion-avatar>

        <ion-label>
          <h3>{{ oferta.titulo }}</h3>
          
          <!-- CORRECCIÃ“N: Usamos 'profesion' en lugar de 'empresa' -->
          <p>{{ oferta.profesion }}</p>
          
          <ion-note color="success" class="ion-padding-top d-block">
            <strong>{{ oferta.sueldo }}</strong>
          </ion-note>
          
          <div class="ion-margin-top">
            <ion-note color="medium">
              <ion-icon name="location-outline" style="vertical-align: middle;"></ion-icon>
              {{ oferta.ubicacion }}
            </ion-note>
          </div>
        </ion-label>
      </ion-item>

      <ion-card-content>
        <!-- CORRECCIÃ“N: Usamos 'especificacion' en lugar de 'resumen' -->
        <p class="ion-text-wrap">{{ oferta.especificacion }}</p>
        
        <div class="ion-text-end ion-margin-top">
          <ion-button fill="clear" size="small" (click)="verDetalle(oferta.id); $event.stopPropagation()">
            Ver detalles
            <ion-icon name="arrow-forward-outline" slot="end"></ion-icon>
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </ion-list>
  
  <div style="height: 50px;"></div>

  <!-- BotÃ³n Flotante (FAB) para crear solicitud -->
  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button (click)="irCrearSolicitud()">
      <ion-icon name="add-circle-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>