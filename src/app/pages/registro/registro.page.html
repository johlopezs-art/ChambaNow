<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/login" text=""></ion-back-button>
    </ion-buttons>
    <ion-title>Crear Cuenta</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <div class="ion-text-center ion-margin-bottom">
    <h2>Regístrate</h2>
    <p class="ion-text-muted">Completa tus datos para comenzar</p>
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()">

    <!-- NOMBRE -->
    <ion-item lines="full">
      <ion-icon name="person-outline" slot="start" color="primary"></ion-icon>
      <ion-input 
        label="Nombre" 
        labelPlacement="floating" 
        formControlName="nombre" 
        placeholder="Tu nombre">
      </ion-input>
    </ion-item>
    <ion-note color="danger" class="ion-margin-start" *ngIf="form.get('nombre')?.touched && form.get('nombre')?.invalid">
      El nombre es obligatorio (mín 3 caracteres).
    </ion-note>

    <!-- APELLIDO (NUEVO) -->
    <ion-item lines="full" class="ion-margin-top">
      <ion-icon name="person-outline" slot="start" color="primary"></ion-icon>
      <ion-input 
        label="Apellido" 
        labelPlacement="floating" 
        formControlName="apellido" 
        placeholder="Tu apellido">
      </ion-input>
    </ion-item>
    <ion-note color="danger" class="ion-margin-start" *ngIf="form.get('apellido')?.touched && form.get('apellido')?.invalid">
      El apellido es obligatorio (mín 3 caracteres).
    </ion-note>

    <!-- EMAIL (Corregido de 'correo' a 'email') -->
    <ion-item lines="full" class="ion-margin-top">
      <ion-icon name="mail-outline" slot="start" color="primary"></ion-icon>
      <ion-input 
        label="Correo Electrónico" 
        labelPlacement="floating" 
        formControlName="email" 
        type="email" 
        placeholder="ejemplo@correo.com">
      </ion-input>
    </ion-item>
    <ion-note color="danger" class="ion-margin-start" *ngIf="form.get('email')?.touched && form.get('email')?.invalid">
      Debe ser un correo válido.
    </ion-note>

    <!-- PASSWORD -->
    <ion-item lines="full" class="ion-margin-top">
      <ion-icon name="lock-closed-outline" slot="start" color="primary"></ion-icon>
      <ion-input 
        label="Contraseña" 
        labelPlacement="floating" 
        formControlName="password" 
        type="password">
      </ion-input>
    </ion-item>
    <ion-note color="danger" class="ion-margin-start" *ngIf="form.get('password')?.touched && form.get('password')?.invalid">
      La contraseña es obligatoria (mín 6 caracteres).
    </ion-note>

    <!-- CONFIRMAR PASSWORD -->
    <ion-item lines="full" class="ion-margin-top">
      <ion-icon name="lock-closed-outline" slot="start" color="primary"></ion-icon>
      <ion-input 
        label="Confirmar Contraseña" 
        labelPlacement="floating" 
        formControlName="confirmarPassword" 
        type="password">
      </ion-input>
    </ion-item>
    
    <!-- Error de coincidencia de contraseñas (Nivel Formulario) -->
    <ion-note color="danger" class="ion-margin-start" *ngIf="form.errors?.['mismatch'] && (form.get('confirmarPassword')?.touched || form.get('password')?.touched)">
       Las contraseñas no coinciden.
    </ion-note>

    <div class="ion-margin-top ion-padding-top">
      <ion-button type="submit" expand="block" shape="round" [disabled]="form.invalid">
        <ion-icon slot="start" name="create-outline"></ion-icon>
        Registrarme
      </ion-button>
    </div>

  </form>
</ion-content>